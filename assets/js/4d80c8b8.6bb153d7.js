"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6108],{1078:(e,a,i)=>{i.r(a),i.d(a,{assets:()=>l,contentTitle:()=>c,default:()=>m,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"examples/guides/camera-calibration","title":"Camera calibration","description":"This example only works on Linux hosts as it requires graphics forwarding from Docker to your host machine.","source":"@site/core_versioned_docs/version-v4/examples/guides/camera-calibration.md","sourceDirName":"examples/guides","slug":"/examples/guides/camera-calibration","permalink":"/core/v4/examples/guides/camera-calibration","draft":false,"unlisted":false,"editUrl":"https://github.com/aica-technology/api/tree/main/docs/core_versioned_docs/version-v4/examples/guides/camera-calibration.md","tags":[],"version":"v4","sidebarPosition":13,"frontMatter":{"sidebar_position":13,"title":"Camera calibration"},"sidebar":"examplesSidebar","previous":{"title":"CameraStreamer component","permalink":"/core/v4/examples/guides/camera-streamer"},"next":{"title":"Core Components","permalink":"/core/v4/category/core-components"}}');var n=i(4848),t=i(8453);const o=i.p+"assets/images/camera-calibration-ab5ea6c2760b64c57686d607dafed94b.gif",s={sidebar_position:13,title:"Camera calibration"},c="Camera calibration",l={},d=[{value:"Calibrate camera using AICA Studio and a checkerboard",id:"calibrate-camera-using-aica-studio-and-a-checkerboard",level:2}];function h(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.header,{children:(0,n.jsx)(a.h1,{id:"camera-calibration",children:"Camera calibration"})}),"\n",(0,n.jsx)(a.admonition,{type:"info",children:(0,n.jsx)(a.p,{children:"This example only works on Linux hosts as it requires graphics forwarding from Docker to your host machine."})}),"\n",(0,n.jsx)(a.p,{children:"Accurate camera calibration is essential for ensuring that visual detections and measurements correspond correctly to\nreal-world geometry. In many perception pipelines, critical output is expressed in image pixel coordinates. However, if\nyour camera's lens introduces distortion or if the intrinsic parameters are unknown, these pixel coordinates can deviate\nsignificantly from their true position."}),"\n",(0,n.jsx)(a.p,{children:"A calibration procedure allows you to determine your camera's intrinsic (focal length, optical center) and extrinsic\n(position, orientation) parameters, as well as its distortion coefficients. Once known, these parameters can be used to\nundistort images in real time, improving the spatial accuracy of detections and any downstream estimation tasks (e.g.,\npose reconstruction, depth reasoning, or robot alignment)."}),"\n",(0,n.jsx)(a.h2,{id:"calibrate-camera-using-aica-studio-and-a-checkerboard",children:"Calibrate camera using AICA Studio and a checkerboard"}),"\n",(0,n.jsxs)(a.p,{children:["If you are using the ",(0,n.jsx)(a.code,{children:"CameraStreamer"})," with a camera with an unknown calibration, we recommend to follow this guide with\nthe code from the corresponding ",(0,n.jsxs)(a.a,{href:"/core/v4/examples/guides/camera-streamer",children:[(0,n.jsx)(a.code,{children:"CameraStreamer"})," example"]}),". Cameras with first-party drivers (such\nas ",(0,n.jsx)(a.a,{href:"/core/v4/examples/guides/realsense-component",children:"RealSense"})," and ",(0,n.jsx)(a.a,{href:"/core/v4/examples/guides/orbbec-component",children:"Orbbec"}),") usually provide the intrinsic parameters\nand distortion coefficients and don't need to be calibrated."]}),"\n",(0,n.jsx)(a.admonition,{type:"note",children:(0,n.jsxs)(a.p,{children:["Instead of using ",(0,n.jsx)(a.code,{children:"CameraStreamer"}),", advanced users can follow this process with any ROS node publishing\n",(0,n.jsx)(a.code,{children:"sensor_msgs::msg::Image"})," messages from a camera."]})}),"\n",(0,n.jsxs)(a.p,{children:["Once you have a established an image stream, make sure to generate a ",(0,n.jsx)(a.strong,{children:"checkerboard"})," pattern (e.g., from\n",(0,n.jsx)(a.a,{href:"https://calib.io/pages/camera-calibration-pattern-generator",children:"here"}),"). The calibrator will use this pattern to determine\nhow the picture is distorted and ultimately generate the necessary matrices that can be used to undistort images from\nyour camera. Take note of the checkerboard width, height, and box size as you will need it later. Print the checkerboard\nand attach it to a flat surface throughout the calibration process."]}),"\n",(0,n.jsx)(a.admonition,{type:"tip",children:(0,n.jsx)(a.p,{children:"Notice that the calibrator is detecting the internal corners of the outermost boxes, so a 8x11 checkerboard will have a\n7x10 area with which the calibrator will work."})}),"\n",(0,n.jsx)(a.p,{children:"Clone our docker image repository in a directory of your choice:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:"git clone https://github.com/aica-technology/docker-images.git && cd docker-images\n"})}),"\n",(0,n.jsx)(a.p,{children:"then:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:"cd camera_calibration\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Within that folder you will find a ",(0,n.jsx)(a.code,{children:"build-run.sh"})," script that, as the name suggests, will build a Docker image and run a\ncontainer with the camera calibration software as an entrypoint."]}),"\n",(0,n.jsxs)(a.p,{children:["Then, run the ",(0,n.jsx)(a.code,{children:"build-run.sh"})," script specifying the necessary parameters similarly to:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:"./build-run.sh --calibration-height 7 --calibration-width 10 --calibration-square 0.015\n"})}),"\n",(0,n.jsx)(a.p,{children:"where the calibration square sizes are in meters."}),"\n",(0,n.jsx)(a.admonition,{type:"warning",children:(0,n.jsxs)(a.p,{children:["If you are using AICA's ",(0,n.jsx)(a.code,{children:"CameraStreamer"})," example to produce the image stream, the above command should already work.\nIf you are using your own node to stream images, you will likely need to specify which topic the calibrator needs to\nsubscribe to by adding the ",(0,n.jsx)(a.code,{children:"--calibration-topic YOUR_ROS_TOPIC"})," argument to the command above."]})}),"\n",(0,n.jsx)(a.p,{children:"After successfully executing the script, a pop-up window displaying your image stream should appear. If the window is\nnot displaying the image stream, make sure you followed the above steps correctly."}),"\n",(0,n.jsx)(a.p,{children:"When you can see a live feed of your camera:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["Move the checkerboard in various positions and orientations until the ",(0,n.jsx)(a.code,{children:"CALIBRATE"})," button is no longer grayed out (and\nmost of the bars are green, indicating good sample size)."]}),"\n",(0,n.jsxs)(a.li,{children:["Once ",(0,n.jsx)(a.code,{children:"CALIBRATE"})," becomes available, press on it to start computing the camera matrices."]}),"\n",(0,n.jsxs)(a.li,{children:["After it becomes available, click on the ",(0,n.jsx)(a.code,{children:"SAVE"})," button to save a recording of the process."]}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["Back at your host computer's filesystem, you will notice a ",(0,n.jsx)(a.code,{children:"calibration"})," directory has been created on under\n",(0,n.jsx)(a.code,{children:"docker-image/camera_calibration"})," that contains a compressed file. The file itself contains the images that were sampled\nalong with a YAML file containing the camera calibration information."]}),"\n",(0,n.jsxs)(a.p,{children:["Finally, move the YAML file into the ",(0,n.jsx)(a.code,{children:"data"})," folder of your AICA configuration such that it becomes available from AICA\nStudio."]}),"\n",(0,n.jsx)("div",{class:"text--center",children:(0,n.jsx)("img",{src:o,alt:"Camera calibration process"})})]})}function m(e={}){const{wrapper:a}={...(0,t.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},8453:(e,a,i)=>{i.d(a,{R:()=>o,x:()=>s});var r=i(6540);const n={},t=r.createContext(n);function o(e){const a=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function s(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(t.Provider,{value:a},e.children)}}}]);