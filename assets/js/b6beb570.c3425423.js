"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7230],{7876:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"examples/core-controllers/jtc-example","title":"A joint trajectory execution example","description":"Visit our learning platform AICAdemy for an interactive training module with a real robot on this topic:","source":"@site/core/examples/core-controllers/jtc-example.md","sourceDirName":"examples/core-controllers","slug":"/examples/core-controllers/jtc-example","permalink":"/core/examples/core-controllers/jtc-example","draft":false,"unlisted":false,"editUrl":"https://github.com/aica-technology/api/tree/main/docs/core/examples/core-controllers/jtc-example.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"A joint trajectory execution example"},"sidebar":"examplesSidebar","previous":{"title":"Core Controllers","permalink":"/core/category/core-controllers"}}');var o=n(4848),a=n(8453);const i=n.p+"assets/images/jtc-example-overview-3f5d2a338d4e08fc6ffee4d325e1afd4.png",s=n.p+"assets/images/jtc-example-frames-6bef575fb6c3663ce78165cecb1176c1.png",c=n.p+"assets/medias/jtc-example-run-fcc3e73f3b4356695777e41f09793c96.webm",l={sidebar_position:1,title:"A joint trajectory execution example"},d="A joint trajectory execution example",h={},p=[{value:"Setting up the application",id:"setting-up-the-application",level:2},{value:"The example explained",id:"the-example-explained",level:2},{value:"Executing the trajectory",id:"executing-the-trajectory",level:2}];function x(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components},{Details:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"a-joint-trajectory-execution-example",children:"A joint trajectory execution example"})}),"\n",(0,o.jsxs)(t.admonition,{type:"tip",children:[(0,o.jsx)(t.p,{children:"Visit our learning platform AICAdemy for an interactive training module with a real robot on this topic:"}),(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{href:"https://aica.thinkific.com/courses/trajectory-control-on-industrial-manipulators-m41",children:"Trajectory Control on Industrial Manipulators"})})]}),"\n",(0,o.jsx)(t.h2,{id:"setting-up-the-application",children:"Setting up the application"}),"\n",(0,o.jsx)(t.p,{children:'Launch AICA Studio and create a new application by pressing "Create new".'}),"\n",(0,o.jsx)(t.p,{children:"Copy the following YAML and generate the graph."}),"\n",(0,o.jsxs)(n,{children:[(0,o.jsx)("summary",{children:"JTC example application"}),(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-yaml",children:"schema: 2-0-6\ndependencies:\n  core: v5.0.0\nframes:\n  start:\n    reference_frame: world\n    position:\n      x: 0.372464\n      y: 0.048147\n      z: 0.43\n    orientation:\n      w: -0.000563\n      x: 0.707388\n      y: 0.706825\n      z: 0.000001\n  waypoint_1:\n    reference_frame: start\n    position:\n      x: -0.2\n      y: 0\n      z: 0\n    orientation:\n      w: 1\n      x: 0\n      y: 0\n      z: 0\n  waypoint_2:\n    reference_frame: start\n    position:\n      x: 0\n      y: 0.2\n      z: 0\n    orientation:\n      w: 1\n      x: 0\n      y: 0\n      z: 0\n  waypoint_3:\n    reference_frame: start\n    position:\n      x: 0.2\n      y: 0\n      z: 0\n    orientation:\n      w: 1\n      x: 0\n      y: 0\n      z: 0\non_start:\n  load:\n    hardware: hardware\nhardware:\n  hardware:\n    display_name: Hardware Interface\n    urdf: Generic six-axis robot arm\n    rate: 100\n    events:\n      transitions:\n        on_load:\n          load:\n            - controller: robot_state_broadcaster\n              hardware: hardware\n            - controller: joint_trajectory_controller\n              hardware: hardware\n    controllers:\n      robot_state_broadcaster:\n        plugin: aica_core_controllers/RobotStateBroadcaster\n        events:\n          transitions:\n            on_load:\n              switch_controllers:\n                hardware: hardware\n                activate: robot_state_broadcaster\n      joint_trajectory_controller:\n        plugin: aica_core_controllers/trajectory/JointTrajectoryController\n        events:\n          predicates:\n            has_trajectory_succeeded:\n              application: stop\n          transitions:\n            on_load:\n              switch_controllers:\n                hardware: hardware\n                activate: joint_trajectory_controller\ngraph:\n  positions:\n    on_start:\n      x: 420\n      y: -20\n    stop:\n      x: 420\n      y: 100\n    buttons:\n      button:\n        x: 100\n        y: 760\n    hardware:\n      hardware:\n        x: 680\n        y: -20\n  buttons:\n    button:\n      display_name: Set desired trajectory\n      on_click:\n        call_service:\n          controller: joint_trajectory_controller\n          hardware: hardware\n          service: set_trajectory\n          payload: |-\n            {\n              frames: [start, waypoint_1, waypoint_2, waypoint_3, start],\n              durations: [2.0]\n            }\n  edges:\n    hardware_hardware_joint_trajectory_controller_has_trajectory_succeeded_on_stop_on_stop:\n      path:\n        - x: 380\n          y: 740\n        - x: 380\n          y: 160\n"})})]}),"\n",(0,o.jsxs)(t.p,{children:["The application graph should show a hardware interface with a ",(0,o.jsx)(t.code,{children:"Joint Trajectory Controller"})," and an event trigger, as\nshown below:"]}),"\n",(0,o.jsx)("div",{class:"text--center",children:(0,o.jsx)("img",{src:i,alt:"Simple JTC configuration"})}),"\n",(0,o.jsx)(t.h2,{id:"the-example-explained",children:"The example explained"}),"\n",(0,o.jsxs)(t.p,{children:["The application starts by loading the ",(0,o.jsx)(t.code,{children:"Robot State Broadcaster"})," and ",(0,o.jsx)(t.code,{children:"Joint Trajectory Controller"})," for the generic\nsix-axis robot. You may already start the application."]}),"\n",(0,o.jsxs)(t.p,{children:["Switch to the 3D view tab of the right panel. You should see your robot in its default joint configuration, along with 4\nCartesian frames named ",(0,o.jsx)(t.strong,{children:"start, waypoint_1, waypoint_2, and waypoint_3"})," that form a triangle. As you may have guessed,\nthis application controls the robot such that it traverses the Cartesian frames in that order."]}),"\n",(0,o.jsx)("div",{class:"text--center",children:(0,o.jsx)("img",{src:s,alt:"Cartesian frames for JTC"})}),"\n",(0,o.jsxs)(t.p,{children:["On the main graph view, turn your attention to the trigger button that connects to the ",(0,o.jsx)(t.code,{children:"Set trajectory"})," service of the\nJoint Trajectory controller. Click on the gear icon on the edge that connects the button to the controller. You will see\nthe following service payload:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-yaml",children:"{\n  frames: [start, waypoint_1, waypoint_2, waypoint_3, start],\n  durations: [2.0]\n}\n"})}),"\n",(0,o.jsx)(t.p,{children:"This message defines 2 of the variables that JTC can use in order to execute a trajectory, namely:"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"frames"}),": a list of the Cartesian frames that you would like to traverse, in the order that they should be visited."]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"durations"}),": a list of absolute durations (in seconds) that correspond to each waypoint."]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["Ensure the ",(0,o.jsx)(t.code,{children:"durations"})," vector is either of the same length as ",(0,o.jsx)(t.code,{children:"frames"})," or has a single element which will be used for\nall waypoints. You can also validate your payload's frame names, by verifying they match with those shown in the 3D view\nor YAML application. This way, you can intuitively anticipate the trajectory execution."]}),"\n",(0,o.jsx)(t.h2,{id:"executing-the-trajectory",children:"Executing the trajectory"}),"\n",(0,o.jsx)(t.p,{children:"Start the application, switch to the 3D view using the mini-view switcher and press the trigger button on the Graph View\ntab to start the execution of the trajectory. The main view should show the robot moving through the waypoints."}),"\n",(0,o.jsx)(t.admonition,{type:"note",children:(0,o.jsx)(t.p,{children:"Payloads cannot be modified or accessed from the Graph view on the right panel or when the application is playing. To\nmodify the payload, stop the application and either switch back to Graph on the main view using the mini-view switcher\nor modify the payload directly on the Code tab of the right panel. In this case, the graph needs to be re-generated."})}),"\n",(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,o.jsxs)("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{maxWidth:"100%",borderRadius:"8px"},children:[(0,o.jsx)("source",{src:c,type:"video/webm"}),(0,o.jsx)(t.p,{children:"JTC in action."})]})}),"\n",(0,o.jsx)("br",{}),"\n",(0,o.jsx)(t.p,{children:"That is all you need to move your robot along predefined poses! Once the trajectory is executed, a predicate is set and\nthe application will automatically stop."}),"\n",(0,o.jsx)(t.p,{children:"Take the time to experiment with different times and/or frame order. While the application is stopped, you may also go\ninto 3D view and drag the waypoints around such that you alter the trajectory."})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(x,{...e})}):x(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>s});var r=n(6540);const o={},a=r.createContext(o);function i(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);