"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[303],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,h=p["".concat(s,".").concat(m)]||p[m]||d[m]||i;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(7294),r=n(6010);const i={tabItem:"tabItem_Ymn6"};function o(e){let{children:t,hidden:n,className:o}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(i.tabItem,o),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(7462),r=n(7294),i=n(6010),o=n(2466),l=n(6550),s=n(1980),c=n(7392),u=n(12);function p(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function d(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??p(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:n}=e;const a=(0,l.k6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s._X)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(a.location.search);t.set(i,e),a.replace({...a.location,search:t.toString()})}),[i,a])]}function g(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,i=d(e),[o,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:i}))),[s,c]=h({queryString:n,groupId:a}),[p,g]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,i]=(0,u.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:a}),f=(()=>{const e=s??p;return m({value:e,tabValues:i})?e:null})();(0,r.useLayoutEffect)((()=>{f&&l(f)}),[f]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),c(e),g(e)}),[c,g,i]),tabValues:i}}var f=n(2389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function k(e){let{className:t,block:n,selectedValue:l,selectValue:s,tabValues:c}=e;const u=[],{blockElementScrollPositionUntilNextRender:p}=(0,o.o5)(),d=e=>{const t=e.currentTarget,n=u.indexOf(t),a=c[n].value;a!==l&&(p(t),s(a))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},t)},c.map((e=>{let{value:t,label:n,attributes:o}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>u.push(e),onKeyDown:m,onClick:d},o,{className:(0,i.Z)("tabs__item",b.tabItem,o?.className,{"tabs__item--active":l===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},i.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function y(e){const t=g(e);return r.createElement("div",{className:(0,i.Z)("tabs-container",b.tabList)},r.createElement(k,(0,a.Z)({},e,t)),r.createElement(v,(0,a.Z)({},e,t)))}function w(e){const t=(0,f.Z)();return r.createElement(y,(0,a.Z)({key:String(t)},e))}},4529:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>p});var a=n(7462),r=(n(7294),n(3905)),i=n(4866),o=n(5162);const l={sidebar_position:4},s="Running the image",c={unversionedId:"getting-started/run",id:"getting-started/run",title:"Running the image",description:"This guide assumes that the AICA runtime application image was tagged as aica-runtime. If the generated image has a",source:"@site/docs/getting-started/04-run.md",sourceDirName:"getting-started",slug:"/getting-started/run",permalink:"/docs/getting-started/run",draft:!1,editUrl:"https://github.com/aica-technology/api/tree/main/docs/docs/getting-started/04-run.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"gettingStartedSidebar",previous:{title:"Installation",permalink:"/docs/getting-started/installation"},next:{title:"Examples",permalink:"/docs/category/examples"}},u={},p=[{value:"Starting the application container",id:"starting-the-application-container",level:2},{value:"Stopping the application container",id:"stopping-the-application-container",level:2},{value:"Access the Developer Interface",id:"access-the-developer-interface",level:2},{value:"Access the REST API",id:"access-the-rest-api",level:2},{value:"Connect a terminal session to the container",id:"connect-a-terminal-session-to-the-container",level:2},{value:"Display sharing",id:"display-sharing",level:3},{value:"Persistent user data",id:"persistent-user-data",level:2}],d={toc:p},m="wrapper";function h(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"running-the-image"},"Running the image"),(0,r.kt)("p",null,"This guide assumes that the AICA runtime application image was tagged as ",(0,r.kt)("inlineCode",{parentName:"p"},"aica-runtime"),". If the generated image has a\ndifferent name, change the name of in the following instructions accordingly."),(0,r.kt)("h2",{id:"starting-the-application-container"},"Starting the application container"),(0,r.kt)("p",null,"You can start the AICA application container with the following command."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Change ",(0,r.kt)("inlineCode",{parentName:"p"},"/path/to/license")," in the command below to the location of the personal AICA developer license assigned to you.\nFor example, use ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.aica-license.toml")," to keep the license file hidden in the home folder.")),(0,r.kt)(i.Z,{groupId:"os",mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"linux",label:"Linux",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -it --rm \\\n  --privileged \\\n  --net=host \\\n  -v /path/to/license:/license:ro \\\n  aica-runtime\n"))),(0,r.kt)(o.Z,{value:"mac",label:"macOS",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -it --rm \\\n  --privileged \\\n  -p 8080:8080 -p 5000:5000 \\\n  -v /path/to/license:/license:ro \\\n  aica-runtime\n")))),(0,r.kt)("p",null,"When the container starts up, it will generate some initial output in the terminal window that should look something\nlike the example below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"[2023-12-11 14:48:38 +0000] [65] [INFO] Starting gunicorn 21.2.0\n[2023-12-11 14:48:38 +0000] [65] [INFO] Listening at: http://0.0.0.0:5000 (65)\n[2023-12-11 14:48:38 +0000] [65] [INFO] Using worker: gthread\n[2023-12-11 14:48:38 +0000] [69] [INFO] Booting worker with pid: 69\n[INFO] [1702306118.970110638] [StateEngine.ServiceHandler]: Initializing state engine services\n[INFO] [1702306118.977229190] [state_engine]: No initial application provided. Use the state engine service interface to set, initialize and start an application.\n[INFO] [1702306119.566053151] [StateEngineInterface]: Successfully connected to Dynamic State Engine services\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"If there are any errors, check that the license file is valid and has been mounted correctly. For example, the following\nerror would be shown from a correctly mounted but invalid license file:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-console"},"[ERROR] [1702306228.377201011] [licensing]: Error: license is invalid (ERR - license is invalid), please check that it is correct\n")),(0,r.kt)("p",{parentName:"admonition"},"Contact AICA support if the container does not start correctly despite a valid license file.")),(0,r.kt)("h2",{id:"stopping-the-application-container"},"Stopping the application container"),(0,r.kt)("p",null,"To shut down the AICA application container at any time, press CTRL+C in the original terminal window. Alternatively,\nto stop the application container from a different terminal window, look up the container name\nwith ",(0,r.kt)("inlineCode",{parentName:"p"},"docker container ps")," and then run ",(0,r.kt)("inlineCode",{parentName:"p"},"docker container stop <container_name>"),"."),(0,r.kt)("h2",{id:"access-the-developer-interface"},"Access the Developer Interface"),(0,r.kt)("p",null,"Visit ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:8080"},"localhost:8080")," in the browser while the container is running to view the Developer\nInterface."),(0,r.kt)("h2",{id:"access-the-rest-api"},"Access the REST API"),(0,r.kt)("p",null,"Visit ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:5000"},"localhost:5000")," to see the Swagger UI and documentation for the REST API."),(0,r.kt)("h2",{id:"connect-a-terminal-session-to-the-container"},"Connect a terminal session to the container"),(0,r.kt)("p",null,"It is sometimes useful to connect to the application container while it is running to inspect files or run commands.\nThis can be accomplished with the ",(0,r.kt)("inlineCode",{parentName:"p"},"docker container exec")," command using the container name."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Change ",(0,r.kt)("inlineCode",{parentName:"p"},"CONTAINER_NAME")," in the command below to the name of the running container.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker container exec -it -u ros2 CONTAINER_NAME /bin/bash\n")),(0,r.kt)("p",null,"The flags ",(0,r.kt)("inlineCode",{parentName:"p"},"-it -u ros2")," tell docker to attach an interactive terminal as the ",(0,r.kt)("inlineCode",{parentName:"p"},"ros2")," user. The command ",(0,r.kt)("inlineCode",{parentName:"p"},"/bin/bash"),"\nstarts a shell process."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"You can find the names of all running containers with the ",(0,r.kt)("inlineCode",{parentName:"p"},"docker ps")," command."),(0,r.kt)("p",{parentName:"admonition"},"Docker containers can also be given an explicit name when started with ",(0,r.kt)("inlineCode",{parentName:"p"},"docker run --name CONTAINER_NAME [...]"),".")),(0,r.kt)("p",null,"Once attached, run any commands in the context of the container. For example, ",(0,r.kt)("inlineCode",{parentName:"p"},"ros2 topic list")," will show the current\nROS 2 topics."),(0,r.kt)("p",null,"Detach from the container with CTRL+D or with the ",(0,r.kt)("inlineCode",{parentName:"p"},"exit")," command."),(0,r.kt)("h3",{id:"display-sharing"},"Display sharing"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Native display sharing for GUI applications is only supported on Linux hosts.")),(0,r.kt)("p",null,"To run GUI applications like RViz in the docker container, it is necessary to share additional environment variables\nfor the display and X11 server."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Running ",(0,r.kt)("inlineCode",{parentName:"p"},"xhost +")," disables access control to the X11 server on the host, allowing the container to access the display.\nIt also allows any other process to access the server, which carries security implications. Use with caution."),(0,r.kt)("p",{parentName:"admonition"},"Access control can be re-enabled with ",(0,r.kt)("inlineCode",{parentName:"p"},"xhost -"),".")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'xhost +\ndocker container exec -it -u ros2 -e DISPLAY="$DISPLAY" -e XAUTHORITY="$XAUTH" CONTAINER_NAME /bin/bash\n')),(0,r.kt)("p",null,"You should then be able to run ",(0,r.kt)("inlineCode",{parentName:"p"},"rviz2")," inside the container and see the window appear."),(0,r.kt)("h2",{id:"persistent-user-data"},"Persistent user data"),(0,r.kt)("p",null,"AICA applications and URDF hardware can be uploaded to a user database through the API or Developer Interface UI.\nBecause the docker container is isolated from the host filesystem, the local database will be lost when the container\nexists. To persist local data between sessions, create a dedicated directory somewhere on the host. For example,\nuse ",(0,r.kt)("inlineCode",{parentName:"p"},"mkdir ~/.aica-data")," to keep the data folder hidden in the home folder. Then execute the normal run command with an\nadditional volume mount for the user data."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Change ",(0,r.kt)("inlineCode",{parentName:"p"},"/path/to/data")," in the command below to a desired location for the data (e.g., ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.aica-data")," or elsewhere)")),(0,r.kt)(i.Z,{groupId:"os",mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"linux",label:"Linux",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -it --rm \\\n  --privileged \\\n  --net=host \\\n  -v /path/to/license:/license:ro \\\n  #highlight-next-line\n  -v /path/to/data:/data:rw \\\n  aica-runtime\n"))),(0,r.kt)(o.Z,{value:"mac",label:"macOS",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -it --rm \\\n  --privileged \\\n  -p 8080:8080 -p 5000:5000 \\\n  -v /path/to/license:/license:ro \\\n  #highlight-next-line\n  -v /path/to/data:/data:rw \\\n  aica-runtime\n")))))}h.isMDXComponent=!0}}]);