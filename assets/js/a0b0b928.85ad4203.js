"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[176],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>f});var a=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=a.createContext({}),s=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},p=function(e){var n=s(e.components);return a.createElement(l.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=s(t),d=o,f=u["".concat(l,".").concat(d)]||u[d]||m[d]||r;return t?a.createElement(f,c(c({ref:n},p),{},{components:t})):a.createElement(f,c({ref:n},p))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,c=new Array(r);c[0]=d;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[u]="string"==typeof e?e:o,c[1]=i;for(var s=2;s<r;s++)c[s]=t[s];return a.createElement.apply(null,c)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},5162:(e,n,t)=>{t.d(n,{Z:()=>c});var a=t(7294),o=t(6010);const r={tabItem:"tabItem_Ymn6"};function c(e){let{children:n,hidden:t,className:c}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(r.tabItem,c),hidden:t},n)}},4866:(e,n,t)=>{t.d(n,{Z:()=>_});var a=t(7462),o=t(7294),r=t(6010),c=t(2466),i=t(6550),l=t(1980),s=t(7392),p=t(12);function u(e){return function(e){return o.Children.map(e,(e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:n,label:t,attributes:a,default:o}}=e;return{value:n,label:t,attributes:a,default:o}}))}function m(e){const{values:n,children:t}=e;return(0,o.useMemo)((()=>{const e=n??u(t);return function(e){const n=(0,s.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function d(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function f(e){let{queryString:n=!1,groupId:t}=e;const a=(0,i.k6)(),r=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l._X)(r),(0,o.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(a.location.search);n.set(r,e),a.replace({...a.location,search:n.toString()})}),[r,a])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:a}=e,r=m(e),[c,i]=(0,o.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!d({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:r}))),[l,s]=f({queryString:t,groupId:a}),[u,g]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[a,r]=(0,p.Nk)(t);return[a,(0,o.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:a}),k=(()=>{const e=l??u;return d({value:e,tabValues:r})?e:null})();(0,o.useLayoutEffect)((()=>{k&&i(k)}),[k]);return{selectedValue:c,selectValue:(0,o.useCallback)((e=>{if(!d({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);i(e),s(e),g(e)}),[s,g,r]),tabValues:r}}var k=t(2389);const h={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function b(e){let{className:n,block:t,selectedValue:i,selectValue:l,tabValues:s}=e;const p=[],{blockElementScrollPositionUntilNextRender:u}=(0,c.o5)(),m=e=>{const n=e.currentTarget,t=p.indexOf(n),a=s[t].value;a!==i&&(u(n),l(a))},d=e=>{let n=null;switch(e.key){case"Enter":m(e);break;case"ArrowRight":{const t=p.indexOf(e.currentTarget)+1;n=p[t]??p[0];break}case"ArrowLeft":{const t=p.indexOf(e.currentTarget)-1;n=p[t]??p[p.length-1];break}}n?.focus()};return o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},n)},s.map((e=>{let{value:n,label:t,attributes:c}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,key:n,ref:e=>p.push(e),onKeyDown:d,onClick:m},c,{className:(0,r.Z)("tabs__item",h.tabItem,c?.className,{"tabs__item--active":i===n})}),t??n)})))}function y(e){let{lazy:n,children:t,selectedValue:a}=e;const r=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===a));return e?(0,o.cloneElement)(e,{className:"margin-top--md"}):null}return o.createElement("div",{className:"margin-top--md"},r.map(((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==a}))))}function v(e){const n=g(e);return o.createElement("div",{className:(0,r.Z)("tabs-container",h.tabList)},o.createElement(b,(0,a.Z)({},e,n)),o.createElement(y,(0,a.Z)({},e,n)))}function _(e){const n=(0,k.Z)();return o.createElement(v,(0,a.Z)({key:String(n)},e))}},3763:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>s});var a=t(7462),o=(t(7294),t(3905));t(4866),t(5162);const r={sidebar_position:1},c="Creating a component package",i={unversionedId:"reference/custom-components/component-package",id:"reference/custom-components/component-package",title:"Creating a component package",description:"Custom components can be defined in ROS 2 packages and used alongside the standard library of AICA components in the",source:"@site/docs/reference/custom-components/01-component-package.md",sourceDirName:"reference/custom-components",slug:"/reference/custom-components/component-package",permalink:"/api/docs/reference/custom-components/component-package",draft:!1,editUrl:"https://github.com/aica-technology/api/tree/main/docs/docs/reference/custom-components/01-component-package.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"programmingReferenceSidebar",previous:{title:"Custom components",permalink:"/api/docs/category/custom-components"},next:{title:"Writing a component",permalink:"/api/docs/reference/custom-components/custom-component"}},l={},s=[{value:"Package infrastructure",id:"package-infrastructure",level:2},{value:"package.xml",id:"packagexml",level:3},{value:"CMakeLists.txt",id:"cmakeliststxt",level:3},{value:"setup.cfg",id:"setupcfg",level:3},{value:"Source directories",id:"source-directories",level:3},{value:"Component descriptions",id:"component-descriptions",level:3}],p={toc:s},u="wrapper";function m(e){let{components:n,...t}=e;return(0,o.kt)(u,(0,a.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"creating-a-component-package"},"Creating a component package"),(0,o.kt)("p",null,"Custom components can be defined in ROS 2 packages and used alongside the standard library of AICA components in the\nAICA application framework. Components can be implemented in C++ or Python. A component package can contain multiple\ncomponents in either language."),(0,o.kt)("h2",{id:"package-infrastructure"},"Package infrastructure"),(0,o.kt)("p",null,"A minimal directory structure for an example package named ",(0,o.kt)("inlineCode",{parentName:"p"},"custom_component_package")," with C++ and Python component\nimplementations is shown below."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"custom_component_package\n\u2502\n\u251c\u2500\u2500 component_descriptions\n\u2502   \u251c\u2500\u2500 custom_component_package_cpp_component.json\n\u2502   \u2514\u2500\u2500 custom_component_package_py_component.json\n\u2502\n\u251c\u2500\u2500 custom_component_package\n\u2502   \u2514\u2500\u2500 py_component.py\n\u2502\n\u251c\u2500\u2500 include\n\u2502   \u2514\u2500\u2500 custom_component_package\n\u2502       \u2514\u2500\u2500 CppComponent.hpp\n\u2502\n\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 CppComponent.cpp\n\u2502\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 package.xml\n\u2514\u2500\u2500 setup.cfg\n")),(0,o.kt)("p",null,"The following sections describe the package contents in more detail."),(0,o.kt)("h3",{id:"packagexml"},"package.xml"),(0,o.kt)("p",null,"The package manifest file defines the package metadata (name, version, description, maintainer and license) and package\ndependencies. An example including minimal dependencies is given below."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="package.xml"',title:'"package.xml"'},'<?xml version="1.0"?>\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\n<package format="3">\n    <version>0.0.1</version>\n    <name>custom_component_package</name>\n    <description>An example package for custom components</description>\n    <maintainer email="john@example.com">John Doe</maintainer>\n    <license>MIT</license>\n\n    <buildtool_depend>ament_cmake_auto</buildtool_depend>\n    <buildtool_depend>ament_cmake_python</buildtool_depend>\n\n    <depend>modulo_components</depend>\n\n    <export>\n        <build_type>ament_cmake</build_type>\n    </export>\n</package>\n')),(0,o.kt)("h3",{id:"cmakeliststxt"},"CMakeLists.txt"),(0,o.kt)("p",null,"The package build instructions are defined in a ",(0,o.kt)("inlineCode",{parentName:"p"},"CMakeLists.txt")," file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cmake",metastring:'title="CMakeLists.txt"',title:'"CMakeLists.txt"'},"cmake_minimum_required(VERSION 3.15)\nproject(custom_component_package)\n\n# find dependencies\nfind_package(ament_cmake_auto REQUIRED)\nfind_package(ament_cmake_python REQUIRED)\n\nament_auto_find_build_dependencies()\n\ninclude_directories(include)\n\n# highlight-next-line\n### Register and install C++ Components here ###\n\n# install Python modules\nament_python_install_package(${PROJECT_NAME} SCRIPTS_DESTINATION lib/${PROJECT_NAME})\n\n# export JSON component descriptions in the component_descriptions directory\ninstall(DIRECTORY ./component_descriptions\n        DESTINATION .)\n\nament_auto_package()\n")),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"C++ components need to be added as library targets, registered with the ",(0,o.kt)("inlineCode",{parentName:"p"},"rclcpp_components_register_nodes")," macro\nand finally exported with the ",(0,o.kt)("inlineCode",{parentName:"p"},"install")," directive. See the C++ example in the next section.")),(0,o.kt)("h3",{id:"setupcfg"},"setup.cfg"),(0,o.kt)("p",null,"If the package contains any Python components, they need to be registered in a separate ",(0,o.kt)("inlineCode",{parentName:"p"},"setup.cfg")," file. Refer to\nthe Python example in the next section."),(0,o.kt)("p",null,"If a package contains no Python components, the ",(0,o.kt)("inlineCode",{parentName:"p"},"setup.cfg")," file is not needed."),(0,o.kt)("h3",{id:"source-directories"},"Source directories"),(0,o.kt)("p",null,"Relative to the package root, C++ components should have header files defined in an ",(0,o.kt)("inlineCode",{parentName:"p"},"include/<package_name>")," directory\nand source files defined in a ",(0,o.kt)("inlineCode",{parentName:"p"},"src")," directory."),(0,o.kt)("p",null,"Python components should be defined in a subdirectory matching the package name."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Any changes to the standard directory structure must be reflected in the ",(0,o.kt)("inlineCode",{parentName:"p"},"CMakeLists.txt")," file accordingly.")),(0,o.kt)("h3",{id:"component-descriptions"},"Component descriptions"),(0,o.kt)("p",null,"To fully support custom components in the AICA application framework, each new component should be fully described\nby a JSON file according to the component description schema."))}m.isMDXComponent=!0}}]);