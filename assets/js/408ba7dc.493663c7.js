"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2022],{1435:(e,n,a)=>{a.d(n,{A:()=>t});const t=a.p+"assets/images/mock-hardware-example-graph-e40e01d15583a53baf0a042fc4c61301.png"},4561:(e,n,a)=>{a.d(n,{A:()=>t});const t=a.p+"assets/images/mock-hardware-example-rviz-e0b1b45c9e544450cdf745db74241143.png"},8269:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"examples/guides/mock-hardware-example","title":"An application with hardware","description":"Launcher configuration requirements","source":"@site/docs/examples/guides/03-mock-hardware-example.md","sourceDirName":"examples/guides","slug":"/examples/guides/mock-hardware-example","permalink":"/docs/examples/guides/mock-hardware-example","draft":false,"unlisted":false,"editUrl":"https://github.com/aica-technology/api/tree/main/docs/docs/examples/guides/03-mock-hardware-example.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"examplesSidebar","previous":{"title":"The application graph editor","permalink":"/docs/examples/guides/editor-example"},"next":{"title":"A guide on Joint Trajectory workflows","permalink":"/docs/examples/guides/jtc-guide"}}');var r=a(4848),o=a(8453);const i={sidebar_position:3},s="An application with hardware",c={},l=[{value:"Launcher configuration requirements",id:"launcher-configuration-requirements",level:2},{value:"URDF Hardware Manager",id:"urdf-hardware-manager",level:2},{value:"Setting up the application",id:"setting-up-the-application",level:2},{value:"The example explained",id:"the-example-explained",level:2},{value:"Run the application",id:"run-the-application",level:2},{value:"Visualize the mock robot in RViz",id:"visualize-the-mock-robot-in-rviz",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"an-application-with-hardware",children:"An application with hardware"})}),"\n",(0,r.jsx)(n.h2,{id:"launcher-configuration-requirements",children:"Launcher configuration requirements"}),"\n",(0,r.jsx)(n.p,{children:"This example uses an additional Universal Robots collection package, which includes drivers for communicating with\nUR robots and the example URDF content used to visualize the robot arm."}),"\n",(0,r.jsxs)(n.p,{children:["Use AICA Core v4.2.0 together with the ",(0,r.jsx)(n.code,{children:"collections/ur-collection"})," package at version v4.1.0 to reproduce this example."]}),"\n",(0,r.jsx)(n.h2,{id:"urdf-hardware-manager",children:"URDF Hardware Manager"}),"\n",(0,r.jsxs)(n.p,{children:["After starting AICA Studio, open the Hardware Manager\n(",(0,r.jsx)(n.a,{href:"http://localhost:8080/studio/hardware",children:"localhost:8080/studio/hardware"}),"). This page shows a table of available URDF\nfiles in the container database with a name and a description."]}),"\n",(0,r.jsx)(n.p,{children:'AICA hardware collections include example URDFs, which are shown on the table with a pad-lock icon indicating that they\nare not editable. Users can make an editable copy of a selected URDF with the "Save As" button, or upload and edit\ncustom URDFs.'}),"\n",(0,r.jsx)(n.p,{children:'From the hardware manager table, select the entry named "Universal Robots 5e (mock interface)". The URDF content should\nappear on the right side of the page.'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",metastring:'title="Universal Robots 5e (mock interface)"',children:'<?xml version="1.0" ?>\n<robot name="ur5e">\n    <ros2_control name="ur5e_mock" type="system">\n        <hardware>\n            #highlight-next-line\n            <plugin>aica_core_interfaces/MockInterface</plugin>\n        </hardware>\n        ...\n    </ros2_control>\n</robot>\n'})}),"\n",(0,r.jsxs)(n.p,{children:["The selected URDF specifies the hardware plugin ",(0,r.jsx)(n.code,{children:"aica_core_interfaces/MockInterface"}),". This is a generic AICA plugin that\nmocks real robot hardware by perfectly following all commands and reflecting back the robot state."]}),"\n",(0,r.jsx)(n.p,{children:"The mock URDF will be used to demonstrate the hardware interface block in AICA applications."}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["Refer to the overview section ",(0,r.jsx)(n.a,{href:"/docs/concepts/ros-concepts/control",children:"Controlling robots with ros2_control"})," for\nmore context."]})}),"\n",(0,r.jsx)(n.h2,{id:"setting-up-the-application",children:"Setting up the application"}),"\n",(0,r.jsxs)(n.p,{children:["Go to the Editor page using the top navigation bar or at\n",(0,r.jsx)(n.a,{href:"http://localhost:8080/studio/editor",children:"localhost:8080/studio/editor"})," and create a new application."]}),"\n",(0,r.jsx)(n.p,{children:"Enter the following YAML and generate the graph."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"schema: 2-0-2\ndependencies:\n  core: v4.2.0\non_start:\n  load:\n    hardware: mock_hardware\nhardware:\n  mock_hardware:\n    display_name: Hardware Interface\n    urdf: Universal Robots 5e (mock interface)\n    rate: 60\n    events:\n      transitions:\n        on_load:\n          load:\n            controller: robot_state_broadcaster\n            hardware: mock_hardware\n    controllers:\n      robot_state_broadcaster:\n        plugin: aica_core_controllers/RobotStateBroadcaster\ngraph:\n  positions:\n    buttons:\n      button:\n        x: -120\n        y: 260\n    hardware:\n      mock_hardware:\n        x: 500\n        y: -20\n  buttons:\n    button:\n      display_name: Activate Controller\n      on_click:\n        switch_controllers:\n          hardware: mock_hardware\n          activate: robot_state_broadcaster\n"})}),"\n",(0,r.jsx)(n.p,{children:"The application graph should show a hardware interface with a controller and an event trigger."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"mock hardware example graph",src:a(1435).A+"",width:"956",height:"576"})}),"\n",(0,r.jsx)(n.h2,{id:"the-example-explained",children:"The example explained"}),"\n",(0,r.jsxs)(n.p,{children:["The application begins with the ",(0,r.jsx)(n.code,{children:"on_start"})," directive to list the initial application events. In this case, the only\nevent that occurs on start is to load the ",(0,r.jsx)(n.code,{children:"mock_hardware"})," hardware interface."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"on_start:\n  load:\n    hardware: mock_hardware\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Moving down the application, the top-level ",(0,r.jsx)(n.code,{children:"hardware"})," field defines the hardware interfaces in an application. In this\ncase, there is one hardware interface called ",(0,r.jsx)(n.code,{children:"mock_hardware"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"hardware:\n  mock_hardware:\n    display_name: Hardware Interface\n    urdf: Universal Robots 5e (mock interface)\n    rate: 60\n    events:\n      transitions:\n        on_load:\n          load:\n            controller: robot_state_broadcaster\n            hardware: mock_hardware\n    controllers:\n      robot_state_broadcaster:\n        plugin: aica_core_controllers/RobotStateBroadcaster\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"urdf"})," field specifies the ",(0,r.jsx)(n.code,{children:"Universal Robots 5e (mock interface)"})," URDF as identified on the hardware manager page."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"events"})," field lists events that occur on state transitions of the hardware interface. In this case, the ",(0,r.jsx)(n.code,{children:"on_load"}),"\ntransition is used to load a controller once the ardware interface is loaded."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"controllers"})," field lists the controllers associated with the hardware interface. In this example, the only\ncontroller is the ",(0,r.jsx)(n.code,{children:"aica_core_controllers/RobotStateBroadcaster"}),", which is a generic AICA controller that broadcasts the\nrobot joint states and transforms."]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["Learn more about available properties for application hardware on\nthe ",(0,r.jsx)(n.a,{href:"/docs/reference/yaml-syntax",children:"YAML application syntax"})," reference page."]})}),"\n",(0,r.jsxs)(n.p,{children:["At the bottom, the application defines positions of components in the graph and event trigger buttons under the\ntop-level ",(0,r.jsx)(n.code,{children:"graph"})," field."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"graph:\n  positions:\n    buttons:\n      button:\n        x: -120\n        y: 260\n    hardware:\n      mock_hardware:\n        x: 500\n        y: -20\n  buttons:\n    button:\n      display_name: Activate Controller\n      on_click:\n        switch_controllers:\n          hardware: mock_hardware\n          activate: robot_state_broadcaster\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"on_click"})," field of buttons defines the application events that are triggered with the event button is pressed. In\nthis case, it triggers the ",(0,r.jsx)(n.code,{children:"switch_controllers"})," event which is used to activate the ",(0,r.jsx)(n.code,{children:"robot_state_broadcaster"})," controller\non the ",(0,r.jsx)(n.code,{children:"mock_hardware"})," interface."]}),"\n",(0,r.jsx)(n.h2,{id:"run-the-application",children:"Run the application"}),"\n",(0,r.jsx)(n.p,{children:"Putting it all together, pressing Play on this application should load the mock hardware interface and load the\nbroadcaster controller. When the trigger button is pressed in the graph editor, the broadcaster will be activated."}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:['Controllers can also be "auto-activated", similar to the procedure in the\n',(0,r.jsx)(n.a,{href:"/docs/examples/guides/editor-example#auto-lifecycle-events",children:"previous example"}),'. Try to modify this example by removing the trigger\nbutton and navigating to the controller settings to toggle the "auto-activate" behavior. Once the application is started\nagain, the controller should now automatically be active.']})}),"\n",(0,r.jsx)(n.h2,{id:"visualize-the-mock-robot-in-rviz",children:"Visualize the mock robot in RViz"}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"Only users with a Linux host can visualize the robot with RViz. On macOS, AICA Launcher will not show the RViz option."})}),"\n",(0,r.jsx)(n.p,{children:'Open RViz using the gear menu icon in the bottom right of AICA Launcher and choosing the "Launch RViz" option.'}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"A native 3D viewer will be available in AICA Studio for all platforms in an upcoming version."})}),"\n",(0,r.jsx)(n.p,{children:"When the application is playing and the robot broadcaster controller has been activated, the robot model should appear\nin the RViz viewer."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"mock hardware example rviz",src:a(4561).A+"",width:"1862",height:"1187"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>s});var t=a(6540);const r={},o=t.createContext(r);function i(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);